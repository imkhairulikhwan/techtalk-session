// filename: index.html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>[TechTalk] Weekly Session for Knowledge Sharing</title>
  <meta name="description" content="Weekly TechTalk sessions for Software Engineering knowledge sharing." />
  <style>
    :root {
      --bg: #ffffff;
      --text: #1b1b1b;
      --muted: #4b4b4b;
      --primary: #0b5fff;
      --border: #e5e7eb;
      --highlight-bg: #f0f7ff;
      --highlight-border: #cfe3ff;
      --card-bg: #fafafa;
    }
    html, body { background: var(--bg); color: var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; line-height: 1.6; margin: 0; padding: 0; }
    .container { max-width: 840px; margin: 0 auto; padding: 24px; }
    header { margin-bottom: 16px; border-bottom: 1px solid var(--border); padding-bottom: 12px; }
    h1 { font-size: 1.8rem; margin: 0 0 6px; }
    .subtitle { color: var(--muted); font-size: 0.95rem; margin: 0; }
    .notice { background: var(--card-bg); border: 1px solid var(--border); border-radius: 10px; padding: 16px; margin: 18px 0; }
    .intro { margin: 18px 0; font-size: 1rem; }
    .highlight { border: 1px solid var(--highlight-border); background: var(--highlight-bg); border-radius: 10px; padding: 16px; margin: 18px 0; }
    .highlight h2 { margin-top: 0; }
    .session-list { list-style: none; padding: 0; margin: 0; }
    .session-item { border: 1px solid var(--border); border-radius: 10px; padding: 14px; margin: 10px 0; display: grid; grid-template-columns: 140px 1fr; gap: 12px; align-items: start; background: var(--bg); }
    .session-date { font-weight: 600; color: var(--primary); }
    .session-title { margin: 0; font-weight: 600; }
    .session-speaker { color: var(--muted); margin-top: 4px; }
    .footer { margin-top: 28px; color: var(--muted); font-size: 0.95rem; }
    @media (max-width: 560px) { .session-item { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <main class="container" role="main">
    <header>
      <h1>[TechTalk] Weekly Session for Knowledge Sharing</h1>
      <p class="subtitle">Every Thursday (except public holidays or special circumstances)</p>
    </header>

    <section class="intro" aria-label="intro">
      <p>Salam everyone,</p>
      <p>It’s time for TechTalk! We’re gathering to geek out over some tech, share some wins, and maybe troubleshoot a few headaches together.</p>
      <p>This is a judgment-free zone to share knowledge and learn something new (we all learn new things every single day). Whether you are a senior developer or an intern, your input is welcome.</p>
    </section>

    <section class="notice" aria-label="call-to-action">
      <p>Grab a drink and hop into the call.</p>
      <p>Let's learn something new together.</p>
    </section>

    <section id="next-session" class="highlight" aria-live="polite">
      <h2>Next Session</h2>
      <div id="next-session-content"><p>Loading next session…</p></div>
    </section>

    <section aria-label="upcoming-sessions">
      <h2>What’s on the menu?</h2>
      <ul id="sessions" class="session-list"></ul>
    </section>

    <section class="footer" aria-label="footer">
      <p>Hosted on GitHub Pages. Update sessions via <code>sessions.json</code>. Changes auto-deploy.</p>
    </section>
  </main>

  <script>
    async function loadSessions() {
      const container = document.getElementById("sessions");
      const nextContainer = document.getElementById("next-session-content");
      try {
        const res = await fetch("./sessions.json", { cache: "no-cache" });
        if (!res.ok) throw new Error("Failed to load sessions.json: " + res.status);
        const data = await res.json();
        if (!Array.isArray(data)) throw new Error("sessions.json must be an array");
        const sessions = data
          .filter(s => s && typeof s.date === "string" && typeof s.title === "string" && typeof s.speaker === "string")
          .map(s => ({ ...s, d: new Date(s.date + "T00:00:00") }))
          .sort((a, b) => a.d - b.d);

        // Render list
        container.innerHTML = "";
        for (const s of sessions) {
          const li = document.createElement("li");
          li.className = "session-item";

          const date = document.createElement("div");
          date.className = "session-date";
          date.textContent = formatDate(s.d);

          const details = document.createElement("div");
          const title = document.createElement("p");
          title.className = "session-title";
          title.textContent = s.title;

          const speaker = document.createElement("p");
          speaker.className = "session-speaker";
          speaker.textContent = "by " + s.speaker;

          details.appendChild(title);
          details.appendChild(speaker);
          li.appendChild(date);
          li.appendChild(details);
          container.appendChild(li);
        }

        // Render next session
        const now = new Date();
        const todayMidnight = new Date(now.toDateString());
        const upcoming = sessions.filter(s => s.d >= todayMidnight);
        nextContainer.innerHTML = "";
        if (upcoming.length === 0) {
          nextContainer.innerHTML = "<p>No upcoming sessions scheduled. Check back soon!</p>";
        } else {
          const next = upcoming[0];
          const dateEl = document.createElement("p");
          dateEl.innerHTML = "<strong>" + formatDate(next.d) + "</strong>";
          const titleEl = document.createElement("p");
          titleEl.textContent = next.title;
          const speakerEl = document.createElement("p");
          speakerEl.textContent = "by " + next.speaker;

          const thursdayNote = document.createElement("p");
          thursdayNote.style.color = "#4b4b4b";
          thursdayNote.style.marginTop = "8px";
          const weekday = next.d.getDay(); // 4 = Thursday
          thursdayNote.textContent = (weekday !== 4)
            ? "Note: Sessions are typically on Thursday, but this one is scheduled differently."
            : "Sessions are typically on Thursday.";

          nextContainer.appendChild(dateEl);
          nextContainer.appendChild(titleEl);
          nextContainer.appendChild(speakerEl);
          nextContainer.appendChild(thursdayNote);
        }
      } catch (err) {
        console.error(err);
        nextContainer.innerHTML = "<p>Unable to load sessions right now.</p>";
        container.innerHTML = "<li class='session-item'><div class='session-date'>Error</div><div><p class='session-title'>Failed to load sessions.json</p><p class='session-speaker'>Please try again later.</p></div></li>";
      }
    }

    function formatDate(d) {
      return d.toLocaleDateString(undefined, { day: "numeric", month: "long", year: "numeric" });
    }

    loadSessions();
  </script>
</body>
</html>
